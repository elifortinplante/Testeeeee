<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flashcards App</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #a18cd1, #fbc2eb, #8fd3f4);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  width: 90%;
  max-width: 800px;
  background: white;
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  position: relative;
}
h1, h2 { text-align: center; color: #333; }
.hidden { display: none; }
.card-container { perspective: 1000px; margin: 20px 0; position: relative; }
.card {
  width: 100%; height: 350px;
  position: relative; transform-style: preserve-3d;
  transition: transform 0.6s; cursor: pointer;
}
.card.flipped { transform: rotateY(180deg); }
.card-face {
  position: absolute; width: 100%; height: 100%;
  backface-visibility: hidden; border-radius: 20px;
  display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  padding: 20px; box-sizing: border-box;
  font-weight: bold; text-align: center; color: #333;
  overflow: hidden;
}
.card-front { background: #fff; }
.card-back { background: #f0f0f0; transform: rotateY(180deg); }
.card-face img {
  width: auto; max-width: 80%; max-height: 60%;
  margin-bottom: 15px;
  object-fit: contain;
  position: absolute;
}
#card-question, #card-answer {
  position: absolute;
  width: 80%;
  text-align: center;
}
.answer-buttons { display: flex; justify-content: space-between; margin-top: 20px; }
.answer-buttons button {
  flex: 1; margin: 0 5px; padding: 10px;
  font-size: 18px; border: none; border-radius: 12px;
  cursor: pointer; transition: 0.3s;
}
.correct { background: #a0e7a0; }
.incorrect { background: #f28b82; }
.correct:hover { background: #77d677; }
.incorrect:hover { background: #e06666; }
.edit-btn {
  position: absolute;
  top: 10px; right: 10px;
  z-index: 100;
  padding: 6px 10px;
  border: none; border-radius: 8px;
  background: #f0a500;
  color: white; cursor: pointer; font-weight: bold;
}
.handle {
  width: 12px; height: 12px; background: #ff0000;
  position: absolute; cursor: nwse-resize; z-index: 50;
}
</style>
</head>
<body>
<div class="container">

  <!-- Écran jeu -->
  <div id="game-screen">
    <h2 id="game-title"></h2>
    <div class="card-container">
      <div class="card" id="current-card">
        <button id="edit-card-btn" class="edit-btn">Modifier</button>
        <div class="card-face card-front">
          <img id="card-image-front" alt="">
          <div id="card-question"></div>
        </div>
        <div class="card-face card-back">
          <img id="card-image-back" alt="">
          <div id="card-answer"></div>
        </div>
      </div>
    </div>
    <div class="answer-buttons">
      <button class="incorrect" onclick="markAnswer(false)">Mauvais</button>
      <button class="correct" onclick="markAnswer(true)">Bon</button>
    </div>
  </div>

</div>

<script>
// --- Données de test ---
let sets = [{
  title: "Test",
  cards: [
    {question:"Question 1", answer:"Réponse 1", image:""},
    {question:"Question 2", answer:"Réponse 2", image:""}
  ]
}];

let currentSet = sets[0];
let currentCards = [...currentSet.cards];
let currentIndex = 0;
let errors = [];
let editMode = false;

const cardEl = document.getElementById("current-card");
const editBtn = document.getElementById("edit-card-btn");
const frontImg = document.getElementById("card-image-front");
const backImg = document.getElementById("card-image-back");
const frontText = document.getElementById("card-question");
const backText = document.getElementById("card-answer");

function showCard(){
  const card = currentCards[currentIndex];
  frontText.textContent = card.question;
  backText.textContent = card.answer;
  if(card.image){ frontImg.src=backImg.src=card.image; frontImg.style.display=backImg.style.display="block"; }
  else { frontImg.style.display=backImg.style.display="none"; }
  frontImg.style.top = frontImg.style.left = "50%";
  frontImg.style.transform = "translate(-50%,-50%)";
  frontText.style.top = backText.style.top = "70%";
  frontText.style.left = backText.style.left = "50%";
  frontText.style.transform = backText.style.transform = "translate(-50%, -50%)";
  cardEl.classList.remove("flipped");
}

cardEl.onclick = e => { if(!editMode) cardEl.classList.toggle("flipped"); };

editBtn.onclick = ()=>{
  editMode = !editMode;
  if(editMode){ editBtn.textContent="Enregistrer"; enableEdit(); }
  else { editBtn.textContent="Modifier"; saveEdits(); disableEdit(); }
};

function enableEdit(){
  frontText.contentEditable = backText.contentEditable = true;
  makeDraggableResizable(frontImg);
  makeDraggableResizable(backImg);
  makeDraggableResizable(frontText);
  makeDraggableResizable(backText);
}

function disableEdit(){
  frontText.contentEditable = backText.contentEditable = false;
  removeHandles(frontImg);
  removeHandles(backImg);
  removeHandles(frontText);
  removeHandles(backText);
}

function saveEdits(){
  const card = currentCards[currentIndex];
  card.question = frontText.textContent;
  card.answer = backText.textContent;
  card.image = frontImg.src;
  currentSet.cards[currentIndex] = card;
  console.log("Modifications sauvegardées :", card);
}

// --- Fonction avec 4 coins pour redimensionner ---
function makeDraggableResizable(el){
  el.style.position="absolute";
  const parent = el.parentElement;
  const corners = ["tl","tr","bl","br"];
  corners.forEach(c=>{
    const handle=document.createElement("div");
    handle.className="handle "+c;
    if(c.includes("t")) handle.style.top="0"; else handle.style.bottom="0";
    if(c.includes("l")) handle.style.left="0"; else handle.style.right="0";
    parent.appendChild(handle);

    let resizing=false, startX, startY, startWidth, startHeight, startLeft, startTop;
    handle.onmousedown=e=>{
      e.stopPropagation();
      resizing=true;
      startX=e.clientX; startY=e.clientY;
      startWidth=el.offsetWidth; startHeight=el.offsetHeight;
      startLeft=el.offsetLeft; startTop=el.offsetTop;
    };
    document.onmousemove=e=>{
      if(resizing){
        let dx=e.clientX-startX, dy=e.clientY-startY;
        let newWidth=startWidth, newHeight=startHeight, newLeft=startLeft, newTop=startTop;
        if(c.includes("r")) newWidth=startWidth+dx; if(c.includes("l")) { newWidth=startWidth-dx; newLeft=startLeft+dx; }
        if(c.includes("b")) newHeight=startHeight+dy; if(c.includes("t")) { newHeight=startHeight-dy; newTop=startTop+dy; }
        el.style.width=newWidth+"px";
        el.style.height=newHeight+"px";
        el.style.left=newLeft+"px";
        el.style.top=newTop+"px";
      }
    };
    document.onmouseup=e=>{ resizing=false; };
  });

  // Déplacement libre
  let dragging=false, startX, startY, startLeft, startTop;
  el.onmousedown=e=>{
    if(e.target.classList.contains("handle")) return;
    dragging=true; startX=e.clientX; startY=e.clientY;
    startLeft=el.offsetLeft; startTop=el.offsetTop;
    e.preventDefault();
  };
  document.onmousemove=e=>{
    if(dragging){
      let dx=e.clientX-startX, dy=e.clientY-startY;
      el.style.left=startLeft+dx+"px";
      el.style.top=startTop+dy+"px";
    }
  };
  document.onmouseup=e=>{ dragging=false; };
}

function removeHandles(el){
  const parent=el.parentElement;
  parent.querySelectorAll(".handle").forEach(h=>h.remove());
}

function markAnswer(correct){ if(!correct) errors.push(currentCards[currentIndex]); currentIndex++; if(currentIndex<currentCards.length) showCard(); else alert("Fin du jeu"); }

showCard();
</script>
</body>
</html>
